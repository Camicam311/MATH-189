---
title: "Math189Pr_3"
output: html_document
---

Overall Question: How do we find clusters of palindromes? How do we determine whether a cluster is just a chance occurrence or a potential replication site?

# Import Dataset
```{r}
location <- read.table("hcmv-25kgjn1-1rfrtkc.txt", header = TRUE)
raw <- read.csv("RAW_DATA-2iwcznn-2kr2xw0.csv", header = TRUE)
```

# Random Scatter
Generate structure that examine the locations of the palindromes. Simulate 296 palindrome sites chosen at random along a DNA sequence of 229,354 bases using a pseudo random number generator. 
```{r}
set.seed(2017)
# Generate simple random sample
N <- 229354
n <- 296
theo <- sample.int( N, size = n)
theo
```

# Visulization of the distribution of palindrome sites location
```{r}
hist(theo, breaks = 100, probability = TRUE, col = 3, main = "Simple Random Sample Distribution")
lines(density(theo, adjust = 2), col = 2)
hist(location$location, breaks = 100, probability = TRUE, col = 3, main = 'Actual Data Distribution')
lines(density(location$location, adjust = 2), col = 2)
```

```{r}
# Group the data (Still Figuring out)
k <- 45
tab <- table(cut(theo, breaks = seq(0, 230000, length.out = k+1), include.lowest = TRUE))
tab
counts <- as.vector(tab)
counts
```

```{r}
hist(counts, breaks = 15, col = rgb(1,0,0,0.5), probability = TRUE, xlab = "number of points inside an interval", ylim = c(0,0.2))
lines(density(counts, adjust = 2), col = rgb(1,0,0,0.5))
Pois <- rpois(1000, lambda = mean(counts))
hist(Pois, breaks = 15, col = rgb(0,0,1,0.5), probability = TRUE, add = TRUE)
lines(density(Pois, adjust = 2), col = rgb(0,0,1,0.5))
legend(x = 14, y = 0.15, legend = c("sample", "Poisson"), lty = c(1,1), col = c(rgb(1,0,0,0.5), rgb(0,0,1,0.5)))
```


## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
